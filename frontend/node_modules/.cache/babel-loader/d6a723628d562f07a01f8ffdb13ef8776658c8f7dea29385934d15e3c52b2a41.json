{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{useSelector,useDispatch}from'react-redux';import{Container,Row,Col,Form,Button}from'react-bootstrap';import{updateProfile}from'../redux/actions/UserActions';import Message from'../components/Message';import Loader from'../components/Loader';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfileScreen=()=>{const dispatch=useDispatch();let navigate=useNavigate();// Initialize navigate\nconst[name,setName]=useState(\"\");const[email,setEmail]=useState(\"\");const[avatar,setAvatar]=useState(\"\");const{userInfo}=useSelector(state=>state.userLogin);const{success,loading,error}=useSelector(state=>state.profileUpdate);const handleSubmit=e=>{e.preventDefault();dispatch(updateProfile({name,email,avatar}));};useEffect(()=>{if(userInfo){setName(userInfo.name);setEmail(userInfo.email);setAvatar(userInfo.avatar);}// Redirect to home or profile page after successful update\nif(success){setTimeout(()=>{navigate('/profile');// Redirect to profile page (or another page)\n},2000);// Optional delay for message visibility\n}},[userInfo,dispatch,success,navigate]);// Include 'navigate' in the dependency array\nconst handleUpload=async e=>{var _target$files;const target=e.target;if(!((_target$files=target.files)!==null&&_target$files!==void 0&&_target$files.length)){return;}const file=target.files[0];const formData=new FormData();formData.append(\"image\",file);try{const config={headers:{\"Content-Type\":\"multipart/form-data\"}};const{data}=await axios.post(\"/api/uploads\",formData,config);setAvatar(data);}catch(error){console.log(error.message);}};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Row,{className:\"justify-content-center\",children:/*#__PURE__*/_jsxs(Col,{xs:12,md:6,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb-4\",children:\"Update Profile\"}),error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}),success&&/*#__PURE__*/_jsx(Message,{variant:\"primary\",children:\"Profile Updated\"}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"name\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Full Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:name,placeholder:\"Full Name\",onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"email\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"E-Mail\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",value:email,placeholder:\"E-Mail\",onChange:e=>setEmail(e.target.value)})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"avatar\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Avatar\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",placeholder:\"Avatar\",name:\"image\",onChange:handleUpload})]}),/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:loading?/*#__PURE__*/_jsx(Loader,{}):`Update`})})]})]})})});};export default ProfileScreen;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","axios","useSelector","useDispatch","Container","Row","Col","Form","Button","updateProfile","Message","Loader","jsx","_jsx","jsxs","_jsxs","ProfileScreen","dispatch","navigate","name","setName","email","setEmail","avatar","setAvatar","userInfo","state","userLogin","success","loading","error","profileUpdate","handleSubmit","e","preventDefault","setTimeout","handleUpload","_target$files","target","files","length","file","formData","FormData","append","config","headers","data","post","console","log","message","children","className","xs","md","variant","onSubmit","Group","controlId","Label","Control","type","value","placeholder","onChange"],"sources":["D:/NAM3/DACN/hotel-booking-main/frontend/src/screens/ProfileScreen.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom'; \nimport axios from 'axios';\nimport { useSelector, useDispatch, RootStateOrAny } from 'react-redux';\nimport { Container, Row, Col, Form, Button } from 'react-bootstrap';\nimport { updateProfile } from '../redux/actions/UserActions';\nimport Message from '../components/Message';\nimport Loader from '../components/Loader';\nimport { IUser } from '../interfaces/IUser';\n\nconst ProfileScreen: React.FC = () => {\n\n    const dispatch = useDispatch();\n    let navigate = useNavigate();  // Initialize navigate\n    const [name, setName] = useState<IUser['name']>(\"\");\n    const [email, setEmail] = useState<IUser['email']>(\"\");\n    const [avatar, setAvatar] = useState<IUser['avatar']>(\"\");\n\n    const { userInfo } = useSelector((state: RootStateOrAny) => state.userLogin);\n\n    const { success, loading, error } = useSelector((state: RootStateOrAny) => state.profileUpdate);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        dispatch(updateProfile({ name, email, avatar }));\n    }\n\n    useEffect(() => {\n\n        if (userInfo) {\n            setName(userInfo.name);\n            setEmail(userInfo.email);\n            setAvatar(userInfo.avatar);\n        }\n\n        // Redirect to home or profile page after successful update\n        if (success) {\n            setTimeout(() => {\n                navigate('/profile'); // Redirect to profile page (or another page)\n            }, 2000); // Optional delay for message visibility\n        }\n      \n    }, [userInfo, dispatch, success, navigate]);  // Include 'navigate' in the dependency array\n\n    const handleUpload = async (e: React.ChangeEvent) => {\n\n        const target = e.target as HTMLInputElement;\n\n        if (!target.files?.length) {\n            return;\n        }\n\n        const file = target.files[0];\n\n        const formData = new FormData();\n\n        formData.append(\"image\", file);\n\n        try {\n            \n            const config = {\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                }\n            }\n\n            const { data } = await axios.post(\"/api/uploads\", formData, config);\n\n            setAvatar(data);\n\n        } catch (error: any) {\n            console.log(error.message);\n        }\n\n    }\n\n  return (\n      <Container>\n        <Row className='justify-content-center'>\n            <Col xs={12} md={6}>\n                <h2 className=\"mb-4\">Update Profile</h2>\n                {error && <Message variant=\"danger\">{error}</Message>}\n                {success && <Message variant=\"primary\">Profile Updated</Message>}\n                <Form onSubmit={handleSubmit}>\n                    <Form.Group controlId=\"name\" className=\"mb-3\">\n                        <Form.Label>Full Name</Form.Label>\n                        <Form.Control \n                            type=\"text\" \n                            value={name} \n                            placeholder=\"Full Name\" \n                            onChange={(e) => setName(e.target.value)}\n                        >\n                        </Form.Control>\n                    </Form.Group>\n                    <Form.Group controlId=\"email\" className=\"mb-3\">\n                        <Form.Label>E-Mail</Form.Label>\n                        <Form.Control \n                            type=\"email\" \n                            value={email} \n                            placeholder=\"E-Mail\" \n                            onChange={(e) => setEmail(e.target.value)}\n                        >\n                        </Form.Control>\n                    </Form.Group>\n                    <Form.Group controlId=\"avatar\" className=\"mb-3\">\n                        <Form.Label>Avatar</Form.Label>\n                        <Form.Control \n                            type=\"file\" \n                            placeholder=\"Avatar\"\n                            name=\"image\"\n                            onChange={handleUpload}\n                        >\n                        </Form.Control>\n                    </Form.Group>\n                    <Form.Group>\n                        <Button variant=\"primary\" type=\"submit\">\n                            {loading ? <Loader /> : `Update`}\n                        </Button>\n                    </Form.Group>\n                </Form>\n            </Col>\n        </Row>\n    </Container>\n  );\n};\n\nexport default ProfileScreen;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}